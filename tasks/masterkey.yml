---
- name: Create Passphrase File
  shell: "openssl rand -base64 14 > passphrase.txt"

- name: Generate Master Encryption Key
  shell: "confluent secret master-key generate --local-secrets-file security.properties \
           --passphrase @passphrase.txt | awk '/Master/{print $5}'"
  register: masterkey

- name: Save Master Encryption Key
  set_fact: secrets_protection_masterkey=masterkey.stdout

- name: Debug
  debug: msg={{secrets_protection_masterkey}}

- fail:
